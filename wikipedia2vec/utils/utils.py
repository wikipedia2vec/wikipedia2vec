import re
from typing import Dict, List

# Obtained from https://huggingface.co/datasets/wikipedia/blob/2e41d367ecfba2e2b71ee5afa283ed6d98302359/wikipedia.py#L618
CATEGORY_ALIASES: Dict[str, List[str]] = {
    "ab": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ", "ÐÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð°"],
    "ace": ["Kawan", "Kategori"],
    "af": ["Kategorie"],
    "ak": ["Nkyekyem"],
    "als": ["Kategorie"],
    "am": ["áˆ˜á‹°á‰¥"],
    "an": ["CategorÃ­a"],
    "ang": ["Flocc"],
    "ar": ["ØªØµÙ†ÙŠÙ"],
    "arc": ["Ü£Ü•ÜªÜ"],
    "arz": ["ØªØµÙ†ÙŠÙ"],
    "as": ["CAT", "à¦¶à§à§°à§‡à¦£à§€", "à¤¶à¥à¤°à¥‡à¤£à¥€", "à¦¶à§à¦°à§‡à¦£à§€"],
    "ast": ["CategorÃ­a"],
    "atj": ["Tipanictawin"],
    "av": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "ay": ["CategorÃ­a"],
    "az": ["Kateqoriya"],
    "azb": ["Ø¨Ø¤Ù„Ù…Ù‡"],
    "ba": ["Ð¢Ó©Ñ€ÐºÓ©Ð¼", "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "bar": ["Kategorie"],
    "bat-smg": ["Kategorija", "KateguorÄ—jÄ—"],
    "bcl": ["Kategorya"],
    "be": ["ÐšÐ°Ñ‚ÑÐ³Ð¾Ñ€Ñ‹Ñ"],
    "be-x-old": ["ÐšÐ°Ñ‚ÑÐ³Ð¾Ñ€Ñ‹Ñ"],
    "bg": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "bh": ["à¤¶à¥à¤°à¥‡à¤£à¥€"],
    "bjn": ["Tumbung", "Kategori"],
    "bm": ["CatÃ©gorie"],
    "bn": ["à¦¬à¦¿à¦·à¦¯à¦¼à¦¶à§à¦°à§‡à¦£à§€", "à´µà´¿à´­à´¾à´—à´‚"],
    "bpy": ["à¦¥à¦¾à¦•"],
    "br": ["Rummad"],
    "bs": ["Kategorija"],
    "bug": ["Kategori"],
    "bxr": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸", "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "ca": ["Categoria"],
    "cbk-zam": ["CategorÃ­a"],
    "cdo": ["åˆ†é¡ž"],
    "ce": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸", "Ð¢Ð¾Ð±Ð°", "ÐšÐ°Ð´ÐµÐ³Ð°Ñ€"],
    "ceb": ["Kategoriya"],
    "ch": ["Katigoria"],
    "ckb": ["Ù¾", "Ù¾Û†Ù„"],
    "co": ["Categoria"],
    "crh": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ", "Kategoriya"],
    "cs": ["Kategorie"],
    "csb": ["KategÃ²rÃ«jÃ´"],
    "cu": ["ÐšÐ°Ñ‚Ð¸Ð³Ð¾Ñ€Ñ—ï€‘", "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ", "ÐšÐ°Ñ‚Ð¸Ð³Ð¾Ñ€Ñ—ê™—"],
    "cv": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸"],
    "cy": ["Categori"],
    "da": ["Kategori"],
    "de": ["Kategorie"],
    "din": ["BekÃ¤takthook"],
    "diq": ["Kategoriye", "Kategori"],
    "dsb": ["Kategorija"],
    "dty": ["à¤¶à¥à¤°à¥‡à¤£à¥€"],
    "dv": ["Þ¤Þ¨ÞÞ°Þ‰Þª"],
    "el": ["ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±"],
    "eml": ["Categoria"],
    "eo": ["Kategorio"],
    "es": ["CAT", "CategorÃ­a"],
    "et": ["Kategooria"],
    "eu": ["Kategoria"],
    "ext": ["CategorÃ­a", "Categoria"],
    "fa": ["Ø±Ø¯Ù‡"],
    "ff": ["CatÃ©gorie"],
    "fi": ["Luokka"],
    "fiu-vro": ["KatÃµgooria"],
    "fo": ["BÃ³lkur"],
    "fr": ["CatÃ©gorie"],
    "frp": ["CatÃ¨gorie"],
    "frr": ["Kategorie"],
    "fur": ["Categorie"],
    "fy": ["Kategory"],
    "ga": ["Rang", "CatagÃ³ir"],
    "gag": ["Kategori", "Kategoriya"],
    "gan": ["åˆ†é¡ž", "åˆ†ç±»"],
    "gd": ["Roinn-seÃ²rsa"],
    "gl": ["CategorÃ­a"],
    "glk": ["Ø¬Ø±Ú¯Ù‡", "Ø±Ø¯Ù‡"],
    "gn": ["Ã‘emohenda"],
    "gom": ["à¤µà¤°à¥à¤—", "à¤¶à¥à¤°à¥‡à¤£à¥€"],
    "gor": ["Dalala"],
    "got": ["ðŒ·ðŒ°ðŒ½ðƒðŒ°"],
    "gu": ["àª¶à«àª°à«‡àª£à«€", "CAT", "àª¶à«àª°à«‡"],
    "gv": ["Ronney"],
    "hak": ["åˆ†é¡ž"],
    "haw": ["MÄhele"],
    "he": ["×§×˜×’×•×¨×™×”", "×§×˜"],
    "hi": ["à¤¶à¥à¤°", "à¤¶à¥à¤°à¥‡à¤£à¥€"],
    "hif": ["vibhag"],
    "hr": ["CT", "KT", "Kategorija"],
    "hsb": ["Kategorija"],
    "ht": ["Kategori"],
    "hu": ["KategÃ³ria"],
    "hy": ["Ô¿Õ¡Õ¿Õ¥Õ£Õ¸Ö€Õ«Õ¡"],
    "ia": ["Categoria"],
    "id": ["Kategori"],
    "ie": ["Categorie"],
    "ig": ["Ã‰bÃ©oná»r", "Ã’tÃ¹"],
    "ii": ["åˆ†ç±»"],
    "ilo": ["Kategoria"],
    "inh": ["ÐžÐ°Ð³Ó€Ð°Ñ‚"],
    "io": ["Kategorio"],
    "is": ["Flokkur"],
    "it": ["CAT", "Categoria"],
    "ja": ["ã‚«ãƒ†ã‚´ãƒª"],
    "jbo": ["klesi"],
    "jv": ["Kategori"],
    "ka": ["áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ"],
    "kaa": ["Sanat", "Kategoriya", "Ð¡Ð°Ð½Ð°Ñ‚", "Ø³Ø§Ù†Ø§Øª"],
    "kab": ["Taggayt"],
    "kbd": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ", "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "kbp": ["CatÃ©gorie"],
    "kg": ["Kalasi"],
    "kk": ["Sanat", "Ð¡Ð°Ð½Ð°Ñ‚", "Ø³Ø§Ù†Ø§Øª"],
    "kl": ["Sumut_atassuseq", "Kategori", "Sumut atassuseq"],
    "km": ["áž…áŸ†áž“áž¶ážáŸ‹ážáŸ’áž“áž¶áž€áŸ‹áž€áŸ’ážšáž»áž˜", "áž…áŸ†ážŽáž¶ážáŸ‹áž€áŸ’ážšáž»áž˜", "áž…áŸ†ážŽáž¶ážáŸ‹ážáŸ’áž“áž¶áž€áŸ‹áž€áŸ’ážšáž»áž˜"],
    "kn": ["à²µà²°à³à²—"],
    "ko": ["ë¶„ë¥˜"],
    "koi": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "krc": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "ks": ["Ø²Ù²Ú˜"],
    "ksh": ["Saachjropp", "Saachjrop", "Katejori", "Kategorie", "Saachjrupp", "Kattejori", "Sachjrop"],
    "ku": ["KategorÃ®", "Ù¾Û†Ù„"],
    "kv": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "kw": ["Class", "Klass"],
    "ky": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "la": ["Categoria"],
    "lad": ["KateggorÃ­a", "KatÄ“ggorÃ­a", "CategorÃ­a"],
    "lb": ["Kategorie"],
    "lbe": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "lez": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "lfn": ["Categoria"],
    "li": ["Categorie", "Kategorie"],
    "lij": ["CategorÃ®a", "Categoria"],
    "lmo": ["Categuria", "Categoria"],
    "ln": ["CatÃ©gorie"],
    "lo": ["à»àº§àº”"],
    "lrc": ["Ø¯Ø£Ø³Û•"],
    "lt": ["Kategorija"],
    "ltg": ["Kategoreja"],
    "lv": ["Kategorija"],
    "mai": ["CA", "à¤¶à¥à¤°à¥‡à¤£à¥€"],
    "map-bms": ["Kategori"],
    "mdf": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ðµ", "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "mg": ["Sokajy", "CatÃ©gorie"],
    "mhr": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ", "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹"],
    "min": ["Kategori"],
    "mk": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ˜Ð°"],
    "ml": ["à´µà´¿à´­à´¾à´—à´‚", "à´µà´¿", "à´µàµ¼à´—àµà´—à´‚", "à´µ"],
    "mn": ["ÐÐ½Ð³Ð¸Ð»Ð°Ð»"],
    "mr": ["à¤µà¤°à¥à¤—"],
    "mrj": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸", "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "ms": ["Kategori"],
    "mt": ["Kategorija"],
    "mwl": ["Catadorie", "Categoria"],
    "my": ["á€€á€á€¹á€"],
    "myv": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "mzn": ["Ø±Ø¬", "Ø±Ø¯Ù‡"],
    "nah": ["NeneuhcÄyÅtl", "CategorÃ­a"],
    "nap": ["CategurÃ¬a", "Categoria"],
    "nds": ["Kategorie"],
    "nds-nl": ["Categorie", "Kattegerie", "Kategorie"],
    "ne": ["à¤¶à¥à¤°à¥‡à¤£à¥€"],
    "new": ["à¤ªà¥à¤šà¤ƒ"],
    "nl": ["Categorie"],
    "nn": ["Kategori"],
    "no": ["Kategori"],
    "nrm": ["CatÃ©gorie"],
    "nso": ["Setensele"],
    "nv": ["TÊ¼Ã¡Ã¡Å‚Ã¡hÃ¡gi_Ã¡tÊ¼Ã©ego", "TÊ¼Ã¡Ã¡Å‚Ã¡hÃ¡gi Ã¡tÊ¼Ã©ego"],
    "oc": ["Categoria"],
    "olo": ["Kategourii"],
    "or": ["à¬¬à¬¿à¬­à¬¾à¬—", "à¬¶à­à¬°à­‡à¬£à­€"],
    "os": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸"],
    "pa": ["à¨¸à¨¼à©à¨°à©‡à¨£à©€"],
    "pcd": ["CatÃ©gorie"],
    "pdc": ["Abdeeling", "Kategorie"],
    "pfl": ["Kadegorie", "Sachgrubb", "Kategorie"],
    "pi": ["à¤µà¤¿à¤­à¤¾à¤—"],
    "pl": ["Kategoria"],
    "pms": ["CategorÃ¬a"],
    "pnb": ["Ú¯Ù¹Ú¾"],
    "pnt": ["ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Î½"],
    "ps": ["ÙˆÛØ´Ù†ÙŠØ²Ù‡"],
    "pt": ["Categoria"],
    "qu": ["Katiguriya"],
    "rm": ["Categoria"],
    "rmy": ["Shopni"],
    "ro": ["Categorie"],
    "roa-rup": ["Categorie"],
    "roa-tara": ["Categoria"],
    "ru": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ", "Ðš"],
    "rue": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ", "ÐšÐ°Ñ‚ÐµÒ‘Ð¾Ñ€Ñ–Ñ"],
    "rw": ["Ikiciro"],
    "sa": ["à¤µà¤°à¥à¤—à¤ƒ"],
    "sah": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "sat": ["á±›á±·á±šá± "],
    "sc": ["Categoria"],
    "scn": ["CatigurÃ¬a"],
    "sd": ["Ø²Ù…Ø±Ùˆ"],
    "se": ["Kategoriija"],
    "sg": ["CatÃ©gorie"],
    "sh": ["Kategorija", "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ˜Ð°"],
    "si": ["à¶´à·Šâ€à¶»à·€à¶»à·Šà¶œà¶º"],
    "sk": ["KategÃ³ria"],
    "sl": ["Kategorija"],
    "sq": ["Kategoria", "Kategori"],
    "sr": ["Kategorija", "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ˜Ð°"],
    "srn": ["Categorie", "Guru"],
    "stq": ["Kategorie"],
    "su": ["Kategori"],
    "sv": ["Kategori"],
    "sw": ["Jamii"],
    "szl": ["Kategoryjo", "Kategoria"],
    "ta": ["à®ªà®•à¯à®ªà¯à®ªà¯"],
    "tcy": ["à²µà²°à³à²—à³Š"],
    "te": ["à°µà°°à±à°—à°‚"],
    "tet": ["KategorÃ­a", "Kategoria"],
    "tg": ["Ð“ÑƒÑ€Ó¯Ò³"],
    "th": ["à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ"],
    "ti": ["áˆ˜á‹°á‰¥"],
    "tk": ["KategoriÃ½a"],
    "tl": ["Kategorya", "Kaurian"],
    "tpi": ["Grup"],
    "tr": ["Kategori", "KAT"],
    "tt": ["Ð¢Ó©Ñ€ÐºÐµÐ¼", "TÃ¶rkem", "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "ty": ["CatÃ©gorie"],
    "tyv": ["ÐÒ£Ð³Ñ‹Ð»Ð°Ð»", "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "udm": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"],
    "ug": ["ØªÛˆØ±"],
    "uk": ["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ", "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ñ–Ñ"],
    "ur": ["Ø²Ù…Ø±Û"],
    "uz": ["Turkum", "Kategoriya"],
    "vec": ["Categoria"],
    "vep": ["Kategorii"],
    "vi": ["Thá»ƒ_loáº¡i", "Thá»ƒ loáº¡i"],
    "vls": ["Categorie"],
    "vo": ["Klad"],
    "wa": ["Categoreye"],
    "war": ["Kaarangay"],
    "wo": ["WÃ ll", "CatÃ©gorie"],
    "wuu": ["åˆ†ç±»"],
    "xal": ["Ð¯Ð½Ð·", "Ó˜Ó™ÑˆÐ»"],
    "xmf": ["áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ"],
    "yi": ["×§××˜×¢×’××¨×™×¢", "×§×Ö·×˜×¢×’×Ö¸×¨×™×¢"],
    "yo": ["áº¸Ì€ka"],
    "za": ["åˆ†ç±»"],
    "zea": ["Categorie"],
    "zh": ["åˆ†ç±»", "åˆ†é¡ž", "CAT"],
    "zh-classical": ["åˆ†é¡ž", "CAT"],
    "zh-min-nan": ["åˆ†é¡ž", "LÅ«i-piaÌt"],
    "zh-yue": ["åˆ†ç±»", "åˆ†é¡ž", "ç±»", "é¡ž"],
}
_category_re_cache: Dict[str, re.Pattern] = {}


def normalize_title(title: str) -> str:
    return (title[0].upper() + title[1:]).replace("_", " ")


def is_category_title(title: str, language: str) -> bool:
    category_re = _category_re_cache.get(language)
    if category_re is None:
        cat_prefixes = "|".join(["Category"] + CATEGORY_ALIASES.get(language, []))
        category_re = re.compile(f"^(?:{cat_prefixes}):", flags=re.IGNORECASE)
        _category_re_cache[language] = category_re
    return bool(category_re.match(title))
